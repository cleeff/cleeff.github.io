(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var r,a=n(0),l=n.n(a),s=n(47),o=n.n(s),c=(n(56),n(1)),i=n.n(c),u=n(5),p=n(6),h=n(13),f=n(17),d=n(15),v=n(3),y=n(16),m=n(4),w=n(49),g=n(7),k=n(23),b=(n(69),new k.InferenceSession),x="./11_2w4_1100.onnx",S=!1,_="",j=!0;function E(){return O.apply(this,arguments)}function O(){return(O=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.loadModel(x);case 2:S=!0;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return e+11*t}function A(e){var t=e%11;return[t,(e-t)/11]}function G(e,t,n){for(var r=A(t),a=Object(y.a)(r,2),l=a[0],s=a[1],o=new Set([t]),c="0"===n?new Set([s]):new Set([l]),i=new Set(function(e){var t=A(e),n=Object(y.a)(t,2),r=n[0],a=n[1],l=[];return 0!==r&&l.push(C(r-1,a)),0!==r&&10!==a&&l.push(C(r-1,a+1)),0!==a&&l.push(C(r,a-1)),10!==a&&l.push(C(r,a+1)),10!==r&&0!==a&&l.push(C(r+1,a-1)),10!==r&&l.push(C(r+1,a)),l}(t)),u=0;u<e.connected_sets[n].length;u++){var p=new Set(e.connected_sets[n][u]),h=new Set(e.connected_set_rows[n][u]);new Set(Object(v.a)(p).filter((function(e){return i.has(e)}))).size>0&&(o=new Set([].concat(Object(v.a)(o),Object(v.a)(p))),c=new Set([].concat(Object(v.a)(c),Object(v.a)(h))))}return e.connected_sets[n].push(Array.from(o)),e.connected_set_rows[n].push(Array.from(c)),e.last_move=t,c.has(0)&&c.has(10)}var R=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={showRatings:e.initial},r.handleClick=r.handleClick.bind(Object(h.a)(r)),r}return Object(p.a)(n,[{key:"handleClick",value:function(){this.props.toggle(!this.state.showRatings),this.setState((function(e){return{showRatings:!e.showRatings}}))}},{key:"render",value:function(){return l.a.createElement("button",{onClick:this.handleClick},this.state.showRatings?"Hide Ratings":"Show Ratings")}}]),n}(l.a.Component),H={setup:function(){return{cells:Array(121).fill(null),connected_sets:[[],[]],connected_set_rows:[[],[]],winner:null,model_output:Array(121).fill(null),model_display:Array(121).fill(null)}},moves:{clickCell:function(e,t,n){if(1==e.cells.reduce((function(e,t){return e+(t?1:0)}),0)&&"0"==e.cells[n])j=!j,_="Switched!";else{var r=t.currentPlayer;j||(r="0"===t.currentPlayer?"1":"0"),e.cells[n]=r,G(e,n,r)&&(e.winner=r)}}},endIf:function(e,t){if(null!==e.winner)return{winner:e.winner}},turn:{moveLimit:1},ai:{enumerate:function(e,t){for(var n=[],r=0;r<121;r++)null===e.cells[r]&&n.push({move:"clickCell",args:[r]});return n}}},M=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).setDisplayRatings=r.setDisplayRatings.bind(Object(h.a)(r)),r.state={display_ratings:!1},r}return Object(p.a)(n,[{key:"onClick",value:function(e){var t=this;if(this.isActive(e)){var n=j?"0":"1",a=Array.from(this.props.G.cells);a[e]=n,this.props.moves.clickCell(e),this.runModel(a).then((function(e){for(var n=t.props.G.cells.reduce((function(e,t){return e+(t?1:0)}),0),a=-1,l=0;l<121;l++)(n<=1||null===t.props.G.cells[l])&&(-1===a||e[l]>r)&&(a=l,r=e[l]);for(var s=0,o=0;o<121;o++){if(n<=1||null===t.props.G.cells[o])s+=Math.pow(2,e[o]-r)}for(var c=0;c<121;c++)if(n<=1||null===t.props.G.cells[c]){var i=Math.pow(2,e[c]-r);t.props.G.model_display[c]=(100*i/s).toFixed(0)}else t.props.G.model_display[c]="";t.props.moves.clickCell(a)}))}}},{key:"setDisplayRatings",value:function(e){this.setState({display_ratings:e})}},{key:"runModel",value:function(){var e=Object(m.a)(i.a.mark((function e(t){var n,r,a,l,s,o,c,u,p,h,f,d,v,y,m,w,g,x,O,A,G,R,H,M,q,D,T;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,_="waiting for agent to move...",S){e.next=5;break}return e.next=5,E();case 5:if(n=[],j){for(r=0;r<11;r++)for(a=0;a<11;a++)l=C(r,a),n.push("1"===t[l]?1:0);for(s=0;s<11;s++)for(o=0;o<11;o++)c=C(s,o),n.push("0"===t[c]?1:0)}else{for(u=0;u<11;u++)for(p=0;p<11;p++)h=C(p,u),n.push("0"===t[h]?1:0);for(f=0;f<11;f++)for(d=0;d<11;d++)v=C(d,f),n.push("1"===t[v]?1:0)}for(y=[],m=0;m<121;m++)y.push(n[121-m-1]);for(w=0;w<121;w++)y.push(n[242-w-1]);return g=[new k.Tensor(new Float32Array(n),"float32",[1,2,11,11])],x=[new k.Tensor(new Float32Array(y),"float32",[1,2,11,11])],e.next=14,b.run(g);case 14:return O=e.sent,e.next=17,b.run(x);case 17:if(A=e.sent,G=O.values().next().value,R=A.values().next().value,console.log(R),H=[],j)for(M=0;M<11;M++)for(q=0;q<11;q++)D=C(M,q),H.push((G.data[D]+R.data[121-D-1])/2);else H=G.data;for(T=0;T<121;T++)this.props.G.model_output[T]=H[T];return _="",e.abrupt("return",H);case 28:e.prev=28,e.t0=e.catch(0),console.error(e.t0);case 31:case"end":return e.stop()}}),e,this,[[0,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cellStyle",value:function(e){return null===this.props.G.cells[e]?"emptyStyle":"0"===this.props.G.cells[e]?"p1Style":"p2Style"}},{key:"cellText",value:function(e,t){return this.props.G.model_display[e]}},{key:"isActive",value:function(e){return!!this.props.isActive&&null===this.props.G.cells[e]}},{key:"render",value:function(){var e=this;if(this.props.ctx.gameover){var t=j?"0":"1";_=this.props.ctx.gameover.winner===t?"Player has won!":"Agent has won!"}for(var n={fill:"rgb(251, 41, 67)",stroke:"black",strokeWidth:.1},r={fill:"rgb(6, 154, 243)",stroke:"black",strokeWidth:.1},a={fill:"white",stroke:"black",strokeWidth:.1},s=[],o=0;o<11;o++)for(var c=function(t){var c=o+11*t;s.push(l.a.createElement(g.Hexagon,{id:c,key:c,onClick:function(){return e.onClick(c)},cellStyle:"p2Style"===e.cellStyle(c)?r:"p1Style"===e.cellStyle(c)?n:a,q:o,r:t,s:-o-t},l.a.createElement(g.Text,null,e.cellText(c,e.state.display_ratings))))},i=0;i<11;i++)c(i);for(var u=121,p=0;p<11;p++){var h=-1;s.push(l.a.createElement(g.Hexagon,{key:u++,cellStyle:n,q:p,r:h,s:-p-h})),s.push(l.a.createElement(g.Hexagon,{key:u++,cellStyle:r,q:h,r:p,s:-p-h})),h=11,s.push(l.a.createElement(g.Hexagon,{key:u++,cellStyle:n,q:p,r:h,s:-p-h})),s.push(l.a.createElement(g.Hexagon,{key:u++,cellStyle:r,q:h,r:p,s:-p-h}))}return l.a.createElement("div",null,l.a.createElement("div",{class:"intro"},"HexHex - A reinforcement deep learning agent by Simon Buchholz, David Harbecke, and Pascal Van Cleeff.",l.a.createElement("br",null),l.a.createElement("a",{href:"https://github.com/harbecke/hex"},"github.com/harbecke/hex")),l.a.createElement("div",{id:"winner"},_),l.a.createElement("div",{id:"controls"},l.a.createElement(R,{initial:!1,toggle:this.setDisplayRatings})),l.a.createElement("div",{className:"App"},l.a.createElement(g.HexGrid,{width:1e3,height:800,viewBox:"0 -3 30 30"},l.a.createElement(g.Layout,{size:{x:1,y:1},flat:!1,spacing:1},s))))}}]),n}(l.a.Component),q=Object(w.a)({game:H,board:M,debug:!1});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},51:function(e,t,n){e.exports=n(103)},56:function(e,t,n){},69:function(e,t,n){},99:function(e,t){}},[[51,1,2]]]);
//# sourceMappingURL=main.2bd7bd2d.chunk.js.map