{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["sess","InferenceSession","url","sess_init","info","agent_is_blue","load_model","a","loadModel","PosToId","x","y","IdToPos","id","AddStone","G","player_color","new_cc","Set","new_cc_rows","neighbors","push","board_size","Neighbors","idx","connected_sets","length","cc","cc_rows","connected_set_rows","filter","has","size","Array","from","Toggle","props","state","showRatings","initial","handleClick","bind","this","toggle","setState","onClick","React","Component","HexGame","setup","cells","fill","winner","model_output","moves","clickCell","ctx","reduce","cur_player","currentPlayer","endIf","turn","moveLimit","ai","enumerate","i","move","args","HexBoard","setDisplayRatings","display_ratings","isActive","current_player","ai_board","runModel","then","result","best_value","num_moves","best","input_values","input","Tensor","Float32Array","run","output","outputTensor","values","next","value","output_transposed","data","console","error","toFixed","gameover","player","p1Style","stroke","strokeWidth","p2Style","emptyStyle","hexagons","q","r","key","cellStyle","s","cellText","b","class","href","className","width","height","viewBox","flat","spacing","App","Client","game","board","debug","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.52ecbb5c.chunk.js","sourcesContent":["// TODO\n// * monte carlo move selection\n\nimport { Client } from \"boardgame.io/react\";\nimport { HexGrid, Layout, Hexagon, Text } from \"react-hexgrid\";\nimport React from \"react\";\nimport { Tensor, InferenceSession } from \"onnxjs\";\n\nimport \"./App.css\";\n\nconst board_size = 11;\nconst sess = new InferenceSession();\nconst url = \"./11_2w4_1100.onnx\";\n\nlet sess_init = false;\nlet info = \"\";\nlet agent_is_blue = true;\n\nasync function load_model() {\n  await sess.loadModel(url);\n  sess_init = true;\n}\n\nfunction PosToId(x, y) {\n  return x + board_size * y;\n}\nfunction IdToPos(id) {\n  const x = id % board_size;\n  const y = (id - x) / board_size;\n  return [x, y];\n}\n\nfunction Neighbors(id) {\n  const [x, y] = IdToPos(id);\n\n  let neighbors = [];\n  if (x !== 0) {\n    neighbors.push(PosToId(x - 1, y));\n  }\n  if (x !== 0 && y !== board_size - 1) {\n    neighbors.push(PosToId(x - 1, y + 1));\n  }\n  if (y !== 0) {\n    neighbors.push(PosToId(x, y - 1));\n  }\n  if (y !== board_size - 1) {\n    neighbors.push(PosToId(x, y + 1));\n  }\n  if (x !== board_size - 1 && y !== 0) {\n    neighbors.push(PosToId(x + 1, y - 1));\n  }\n  if (x !== board_size - 1) {\n    neighbors.push(PosToId(x + 1, y));\n  }\n\n  return neighbors;\n}\n\nfunction AddStone(G, id, player_color) {\n  const [x, y] = IdToPos(id);\n  let new_cc = new Set([id]);\n  let new_cc_rows = player_color === \"0\" ? new Set([y]) : new Set([x]);\n\n  const neighbors = new Set(Neighbors(id));\n  for (let idx = 0; idx < G.connected_sets[player_color].length; idx++) {\n    let cc = new Set(G.connected_sets[player_color][idx]);\n    let cc_rows = new Set(G.connected_set_rows[player_color][idx]);\n    const intersection = new Set([...cc].filter((x) => neighbors.has(x)));\n    if (intersection.size > 0) {\n      new_cc = new Set([...new_cc, ...cc]);\n      new_cc_rows = new Set([...new_cc_rows, ...cc_rows]);\n    }\n  }\n\n  G.connected_sets[player_color].push(Array.from(new_cc));\n  G.connected_set_rows[player_color].push(Array.from(new_cc_rows));\n  return new_cc_rows.has(0) && new_cc_rows.has(board_size - 1);\n}\n\nclass Toggle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {showRatings: props.initial};\n\n    // This binding is necessary to make `this` work in the callback\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick() {\n    this.props.toggle(!this.state.showRatings);\n    this.setState(state => ({\n      showRatings: !state.showRatings\n    }));\n  }\n\n  render() {\n    return (\n      <button onClick={this.handleClick}>\n        {this.state.showRatings ? 'Hide Ratings' : 'Show Ratings'}\n      </button>\n    );\n  }\n}\n\nconst HexGame = {\n  setup: () => ({\n    cells: Array(board_size * board_size).fill(null),\n    connected_sets: [[], []],\n    connected_set_rows: [[], []],\n    winner: null,\n    model_output: Array(board_size * board_size).fill(null),\n    // index 0 will always be red independent of swap\n    // save a pair of sets for each player:\n    //   * the first set is a connected component of stones\n    //   * the second set is the indices of these stones in the direction\n    //     of the player thus the winning condition is having\n    //     0 and (size-1) in one of the second sets.\n  }),\n\n  moves: {\n    clickCell: (G, ctx, id) => {\n      const num_moves = G.cells.reduce((x, y) => x + (y ? 1 : 0), 0);\n      if (num_moves == 1 && G.cells[id] == '0') {\n        // switch!\n        agent_is_blue = !agent_is_blue;\n        info = \"Switched!\"\n      }\n\n      else {\n        let cur_player = ctx.currentPlayer;\n        if (!agent_is_blue) {\n          cur_player = ctx.currentPlayer === '0' ? '1' : '0';\n        }\n        G.cells[id] = cur_player;\n        const has_won = AddStone(G, id, cur_player);\n        if (has_won) {\n          G.winner = cur_player;\n        }\n      }\n    },\n  },\n\n  endIf: (G, ctx) => {\n    if (G.winner !== null) {\n      return { winner: G.winner };\n    }\n  },\n\n  turn: {\n    moveLimit: 1,\n  },\n\n  ai: {\n    enumerate: (G, ctx) => {\n      let moves = [];\n      for (let i = 0; i < board_size * board_size; i++) {\n        if (G.cells[i] === null) {\n          moves.push({ move: \"clickCell\", args: [i] });\n        }\n      }\n      return moves;\n    },\n  },\n};\n\nclass HexBoard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.setDisplayRatings = this.setDisplayRatings.bind(this);\n    this.state = {display_ratings: false};\n  }\n\n  onClick(id) {\n    if (!this.isActive(id)) {\n      return;\n    }\n    // build board for ai independently from\n    // game mechanics to avoid race conditions.\n    const current_player = agent_is_blue ? \"0\" : \"1\";\n    let ai_board = Array.from(this.props.G.cells);\n    ai_board[id] = current_player;\n\n    // actually make the move\n    this.props.moves.clickCell(id);\n\n    this.runModel(ai_board).then((result) => {\n      // AI move selection\n      const num_moves = this.props.G.cells.reduce((x, y) => x + (y ? 1 : 0), 0);\n      let best = -1;\n      let best_value;\n      for (let i = 0; i < board_size * board_size; i++) {\n        if (num_moves <= 1 || this.props.G.cells[i] === null) {\n          if (best === -1 || result[i] > best_value) {\n            best = i;\n            best_value = result[i];\n          }\n        }\n      }\n      this.props.moves.clickCell(best);\n    });\n  }\n\n  setDisplayRatings(display_ratings) {\n    this.setState({display_ratings: display_ratings});\n  }\n\n  async runModel(cells) {\n    try {\n      info = \"waiting for agent to move...\";\n      if (!sess_init) {\n        await load_model();\n      }\n\n      let input_values = [];\n      if (agent_is_blue) {\n        for (let x = 0; x < board_size; x++) {\n          for (let y = 0; y < board_size; y++) {\n            const id = PosToId(x, y);\n            input_values.push(cells[id] === \"1\" ? 1 : 0);\n          }\n        }\n        for (let x = 0; x < board_size; x++) {\n          for (let y = 0; y < board_size; y++) {\n            const id = PosToId(x, y);\n            input_values.push(cells[id] === \"0\" ? 1 : 0);\n          }\n        }\n      } else {\n        for (let y = 0; y < board_size; y++) {\n          for (let x = 0; x < board_size; x++) {\n            const id = PosToId(x, y);\n            input_values.push(cells[id] === \"0\" ? 1 : 0);\n          }\n        }\n        for (let y = 0; y < board_size; y++) {\n          for (let x = 0; x < board_size; x++) {\n            const id = PosToId(x, y);\n            input_values.push(cells[id] === \"1\" ? 1 : 0);\n          }\n        }\n      }\n      const input = [\n        new Tensor(new Float32Array(input_values), \"float32\", [1, 2, 11, 11]),\n      ];\n      const output = await sess.run(input);\n      const outputTensor = output.values().next().value;\n      let output_transposed = [];\n      if (agent_is_blue){\n        for (let x = 0; x < board_size; x++) {\n          for (let y = 0; y < board_size; y++) {\n            const id = PosToId(x, y);\n            output_transposed.push(outputTensor.data[id]);\n          }\n        }\n      } else {\n        output_transposed = outputTensor.data;\n      }\n\n      for (let i = 0; i < board_size * board_size; i++) {\n        this.props.G.model_output[i] = output_transposed[i];\n      }\n      info = \"\";\n      return output_transposed;\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  cellStyle(id) {\n    if (this.props.G.cells[id] === null) {\n      return \"emptyStyle\";\n    }\n    if (this.props.G.cells[id] === \"0\") {\n      return \"p1Style\";\n    }\n    return \"p2Style\";\n  }\n\n  cellText(id, display_ratings) {\n    if (display_ratings && this.props.G.model_output[0] !== null) {\n      const num_moves = this.props.G.cells.reduce((x, y) => x + (y ? 1 : 0), 0);\n      if (num_moves <= 1 || this.props.G.cells[id] === null) {\n        return this.props.G.model_output[id].toFixed(1);\n      }\n    }\n    return \"\";\n  }\n\n  isActive(id) {\n    if (!this.props.isActive) return false;\n    if (this.props.G.cells[id] !== null) return false;\n    return true;\n  }\n\n  render() {\n    if (this.props.ctx.gameover) {\n      let player = agent_is_blue ? '0' : '1';\n      info = this.props.ctx.gameover.winner === player ? 'Player has won!' : 'Agent has won!';\n    }\n\n    const p1Style = {\n      fill: \"rgb(251, 41, 67)\",\n      stroke: \"black\",\n      strokeWidth: 0.1,\n    };\n    const p2Style = {\n      fill: \"rgb(6, 154, 243)\",\n      stroke: \"black\",\n      strokeWidth: 0.1,\n    };\n    const emptyStyle = {\n      fill: \"white\",\n      stroke: \"black\",\n      strokeWidth: 0.1,\n    };\n\n    let hexagons = [];\n    // field hexagons, initially empty\n    for (let q = 0; q < board_size; q++) {\n      for (let r = 0; r < board_size; r++) {\n        const id = q + r * board_size;\n        hexagons.push(\n          <Hexagon\n            id={id}\n            key={id}\n            onClick={() => this.onClick(id)}\n            cellStyle={\n              this.cellStyle(id) === \"p2Style\"\n                ? p2Style\n                : this.cellStyle(id) === \"p1Style\"\n                ? p1Style\n                : emptyStyle\n            }\n            q={q}\n            r={r}\n            s={-q - r}\n          >\n            <Text>{this.cellText(id, this.state.display_ratings)}</Text>\n          </Hexagon>\n        );\n      }\n    }\n\n    // border hexagons\n    let id = board_size * board_size;\n    for (let a = 0; a < board_size; a++) {\n      let b = -1;\n      hexagons.push(\n        <Hexagon key={id++} cellStyle={p1Style} q={a} r={b} s={-a - b} />\n      );\n      hexagons.push(\n        <Hexagon key={id++} cellStyle={p2Style} q={b} r={a} s={-a - b} />\n      );\n      b = board_size;\n      hexagons.push(\n        <Hexagon key={id++} cellStyle={p1Style} q={a} r={b} s={-a - b} />\n      );\n      hexagons.push(\n        <Hexagon key={id++} cellStyle={p2Style} q={b} r={a} s={-a - b} />\n      );\n    }\n\n    return (\n      <div>\n        <div class=\"intro\">\n          HexHex - A reinforcement deep learning agent by Simon Buchholz, David Harbecke, and Pascal Van Cleeff.\n          <br />\n          <a href=\"https://github.com/harbecke/hex\">github.com/harbecke/hex</a>\n        </div>\n        <div id=\"winner\">{info}</div>\n        <div id=\"controls\">\n          <Toggle initial={false} toggle={this.setDisplayRatings}/>\n        </div>\n        <div className=\"App\">\n          <HexGrid width={1000} height={800} viewBox=\"0 -3 30 30\">\n            <Layout size={{ x: 1, y: 1 }} flat={false} spacing={1}>\n              {hexagons}\n            </Layout>\n          </HexGrid>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst App = Client({ game: HexGame, board: HexBoard, debug: false });\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}