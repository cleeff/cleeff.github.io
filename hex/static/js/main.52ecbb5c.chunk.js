(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),l=n(47),s=n.n(l),c=(n(56),n(1)),o=n.n(c),i=n(5),u=n(6),p=n(13),h=n(17),f=n(15),d=n(3),v=n(16),m=n(4),y=n(49),w=n(7),g=n(31),k=(n(69),new g.InferenceSession),b="./11_2w4_1100.onnx",S=!1,x="",j=!0;function E(){return O.apply(this,arguments)}function O(){return(O=Object(m.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.loadModel(b);case 2:S=!0;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return e+11*t}function C(e){var t=e%11;return[t,(e-t)/11]}function A(e,t,n){for(var r=C(t),a=Object(v.a)(r,2),l=a[0],s=a[1],c=new Set([t]),o="0"===n?new Set([s]):new Set([l]),i=new Set(function(e){var t=C(e),n=Object(v.a)(t,2),r=n[0],a=n[1],l=[];return 0!==r&&l.push(_(r-1,a)),0!==r&&10!==a&&l.push(_(r-1,a+1)),0!==a&&l.push(_(r,a-1)),10!==a&&l.push(_(r,a+1)),10!==r&&0!==a&&l.push(_(r+1,a-1)),10!==r&&l.push(_(r+1,a)),l}(t)),u=0;u<e.connected_sets[n].length;u++){var p=new Set(e.connected_sets[n][u]),h=new Set(e.connected_set_rows[n][u]);new Set(Object(d.a)(p).filter((function(e){return i.has(e)}))).size>0&&(c=new Set([].concat(Object(d.a)(c),Object(d.a)(p))),o=new Set([].concat(Object(d.a)(o),Object(d.a)(h))))}return e.connected_sets[n].push(Array.from(c)),e.connected_set_rows[n].push(Array.from(o)),o.has(0)&&o.has(10)}var G=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={showRatings:e.initial},r.handleClick=r.handleClick.bind(Object(p.a)(r)),r}return Object(u.a)(n,[{key:"handleClick",value:function(){this.props.toggle(!this.state.showRatings),this.setState((function(e){return{showRatings:!e.showRatings}}))}},{key:"render",value:function(){return a.a.createElement("button",{onClick:this.handleClick},this.state.showRatings?"Hide Ratings":"Show Ratings")}}]),n}(a.a.Component),R={setup:function(){return{cells:Array(121).fill(null),connected_sets:[[],[]],connected_set_rows:[[],[]],winner:null,model_output:Array(121).fill(null)}},moves:{clickCell:function(e,t,n){if(1==e.cells.reduce((function(e,t){return e+(t?1:0)}),0)&&"0"==e.cells[n])j=!j,x="Switched!";else{var r=t.currentPlayer;j||(r="0"===t.currentPlayer?"1":"0"),e.cells[n]=r,A(e,n,r)&&(e.winner=r)}}},endIf:function(e,t){if(null!==e.winner)return{winner:e.winner}},turn:{moveLimit:1},ai:{enumerate:function(e,t){for(var n=[],r=0;r<121;r++)null===e.cells[r]&&n.push({move:"clickCell",args:[r]});return n}}},H=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).setDisplayRatings=r.setDisplayRatings.bind(Object(p.a)(r)),r.state={display_ratings:!1},r}return Object(u.a)(n,[{key:"onClick",value:function(e){var t=this;if(this.isActive(e)){var n=j?"0":"1",r=Array.from(this.props.G.cells);r[e]=n,this.props.moves.clickCell(e),this.runModel(r).then((function(e){for(var n,r=t.props.G.cells.reduce((function(e,t){return e+(t?1:0)}),0),a=-1,l=0;l<121;l++)(r<=1||null===t.props.G.cells[l])&&(-1===a||e[l]>n)&&(a=l,n=e[l]);t.props.moves.clickCell(a)}))}}},{key:"setDisplayRatings",value:function(e){this.setState({display_ratings:e})}},{key:"runModel",value:function(){var e=Object(m.a)(o.a.mark((function e(t){var n,r,a,l,s,c,i,u,p,h,f,d,v,m,y,w,b,O,C,A,G;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x="waiting for agent to move...",S){e.next=5;break}return e.next=5,E();case 5:if(n=[],j){for(r=0;r<11;r++)for(a=0;a<11;a++)l=_(r,a),n.push("1"===t[l]?1:0);for(s=0;s<11;s++)for(c=0;c<11;c++)i=_(s,c),n.push("0"===t[i]?1:0)}else{for(u=0;u<11;u++)for(p=0;p<11;p++)h=_(p,u),n.push("0"===t[h]?1:0);for(f=0;f<11;f++)for(d=0;d<11;d++)v=_(d,f),n.push("1"===t[v]?1:0)}return m=[new g.Tensor(new Float32Array(n),"float32",[1,2,11,11])],e.next=10,k.run(m);case 10:if(y=e.sent,w=y.values().next().value,b=[],j)for(O=0;O<11;O++)for(C=0;C<11;C++)A=_(O,C),b.push(w.data[A]);else b=w.data;for(G=0;G<121;G++)this.props.G.model_output[G]=b[G];return x="",e.abrupt("return",b);case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cellStyle",value:function(e){return null===this.props.G.cells[e]?"emptyStyle":"0"===this.props.G.cells[e]?"p1Style":"p2Style"}},{key:"cellText",value:function(e,t){if(t&&null!==this.props.G.model_output[0]&&(this.props.G.cells.reduce((function(e,t){return e+(t?1:0)}),0)<=1||null===this.props.G.cells[e]))return this.props.G.model_output[e].toFixed(1);return""}},{key:"isActive",value:function(e){return!!this.props.isActive&&null===this.props.G.cells[e]}},{key:"render",value:function(){var e=this;if(this.props.ctx.gameover){var t=j?"0":"1";x=this.props.ctx.gameover.winner===t?"Player has won!":"Agent has won!"}for(var n={fill:"rgb(251, 41, 67)",stroke:"black",strokeWidth:.1},r={fill:"rgb(6, 154, 243)",stroke:"black",strokeWidth:.1},l={fill:"white",stroke:"black",strokeWidth:.1},s=[],c=0;c<11;c++)for(var o=function(t){var o=c+11*t;s.push(a.a.createElement(w.Hexagon,{id:o,key:o,onClick:function(){return e.onClick(o)},cellStyle:"p2Style"===e.cellStyle(o)?r:"p1Style"===e.cellStyle(o)?n:l,q:c,r:t,s:-c-t},a.a.createElement(w.Text,null,e.cellText(o,e.state.display_ratings))))},i=0;i<11;i++)o(i);for(var u=121,p=0;p<11;p++){var h=-1;s.push(a.a.createElement(w.Hexagon,{key:u++,cellStyle:n,q:p,r:h,s:-p-h})),s.push(a.a.createElement(w.Hexagon,{key:u++,cellStyle:r,q:h,r:p,s:-p-h})),h=11,s.push(a.a.createElement(w.Hexagon,{key:u++,cellStyle:n,q:p,r:h,s:-p-h})),s.push(a.a.createElement(w.Hexagon,{key:u++,cellStyle:r,q:h,r:p,s:-p-h}))}return a.a.createElement("div",null,a.a.createElement("div",{class:"intro"},"HexHex - A reinforcement deep learning agent by Simon Buchholz, David Harbecke, and Pascal Van Cleeff.",a.a.createElement("br",null),a.a.createElement("a",{href:"https://github.com/harbecke/hex"},"github.com/harbecke/hex")),a.a.createElement("div",{id:"winner"},x),a.a.createElement("div",{id:"controls"},a.a.createElement(G,{initial:!1,toggle:this.setDisplayRatings})),a.a.createElement("div",{className:"App"},a.a.createElement(w.HexGrid,{width:1e3,height:800,viewBox:"0 -3 30 30"},a.a.createElement(w.Layout,{size:{x:1,y:1},flat:!1,spacing:1},s))))}}]),n}(a.a.Component),q=Object(y.a)({game:R,board:H,debug:!1});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},51:function(e,t,n){e.exports=n(103)},56:function(e,t,n){},69:function(e,t,n){},99:function(e,t){}},[[51,1,2]]]);
//# sourceMappingURL=main.52ecbb5c.chunk.js.map